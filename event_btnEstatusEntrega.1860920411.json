{
	"type": "EVENT_BUTTON",
	"name": "btnEstatusEntrega",
	"serverCode": "\n",
	"beforeJsCode": "// this.recordData tiene los campos de la fila\r\nvar idsolicitud = row.getFieldValue(\"idsolicitud\");\r\n\r\nif(!idsolicitud){\r\n    alert(\"No se pudo determinar la solicitud.\");\r\n    return;\r\n}\r\n\r\n// abre el ADD de la otra tabla en una ventana\r\nvar url = \"estatusentregas_historial_add.php?idsolicitud=\" + encodeURIComponent(idsolicitud);\r\nvar w = 500;\r\nvar h = 400;\r\n\r\n// Posición del navegador (soporta varios monitores)\r\nvar dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\r\nvar dualScreenTop  = window.screenTop  !== undefined ? window.screenTop  : window.screenY;\r\n\r\n// Tamaño de la ventana del navegador\r\nvar width  = window.innerWidth  ? window.innerWidth  : document.documentElement.clientWidth  ? document.documentElement.clientWidth  : screen.width;\r\nvar height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\r\n\r\n// Cálculo centrado\r\nvar left = dualScreenLeft + (width  - w) / 2;\r\nvar top  = dualScreenTop  + (height - h) / 2;\r\n\r\n// Abrir popup centrado\r\nvar features =\r\n    \"width=\" + w +\r\n    \",height=\" + h +\r\n    \",left=\" + left +\r\n    \",top=\" + top +\r\n    \",scrollbars=1,resizable=1\";\r\n\r\n// ===== Reusar ventana si ya existe =====\r\nif (!window._decWin || window._decWin.closed) {\r\n    // No existe: la abrimos\r\n    window._decWin = window.open(url, \"estatus_hist\", features);\r\n} else {\r\n    // Ya existe: solo cambiamos la URL y la traemos al frente\r\n    window._decWin.location.href = url;\r\n    window._decWin.focus();\r\n}\r\nreturn false;"
}